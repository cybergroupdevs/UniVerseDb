SUBROUTINE TEST(P.RTN,P.PASS,P.ERR,P.WARN)
*initialising variables
P.RTN= ""; P.ERR ="";P.WARN =""
RIDE.REC = ""
ARRAY.DATA =""
I = 0
*opening files
OPEN P.PASS TO FILE.PTR ELSE PRINT "ERROR"
*main
GOSUB GET.DICT
GOSUB GET.DATA
RETURN
*******
GET.DICT:
CMD = "SELECT DICT ":P.PASS
EXECUTE CMD
LOOP
  READNEXT ID ELSE ID =""
UNTIL ID = "" DO
  I = I + 1	
  ARRAY.DATA <1,I> = ID
REPEAT
P.RTN=ARRAY.DATA
RETURN
*
GET.DATA:
CMD = ""; ID = "";
I = 0
CMD = "SSELECT DATA ":P.PASS
EXECUTE CMD
LOOP
  READNEXT ID ELSE ID =""
UNTIL ID = "" DO
  I=I+1
  READ RIDE.REC FROM FILE.PTR,ID THEN
    ARRAY.DATA<2,I> = ID
    ARRAY.DATA<3,I> = RIDE.REC<1>
    ARRAY.DATA<4,I> = EREPLACE(RIDE.REC<2>,@VM, " , ")
    ARRAY.DATA<5,I> = EREPLACE(RIDE.REC<3>,@VM, " , ")
  END
REPEAT
PRINT ARRAY.DATA<1,I>
P.RTN=ARRAY.DATA
RETURN
